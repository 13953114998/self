# mqtt_client_baseband_master 
### base_master 控制业务主程序
* 通过TCP链接控制链接的baseband(基带设备)。
* 通过http协议 POST模式将数据上传给服务器端以便入库。
* (自身信息、基带设备信息、基带工作状态信息、客户采集信息...)
* 通过使用MQTT协议,作为订阅者链接MQTT 服务端接受指令下发。
* 通过UDP协议将采集到的IMSI、IMEI信息发送到指定服务器。
* 创建SQLite数据库保存采集信息
* 创建缓存文件,保存历史采集数据
* 创建文件保存基带板频点信息

* cmake -DAUTH="ON" -DDEBUG="ON" -DVMWORK="ON" -DSYS86="ON" -DSAVESQL="ON" -DSCACHE="ON" -DMD5POS="MAC" .
### recev_imsi_udp 辅助程序
* 作为UDP服务器接收base_master 程序采集的IMSI、IMEI信息。 

-------------------------------------------------------------------------------
### 配置文件配置项介绍
#### 文件名称：/etc/base_master.cfg
#### TCP 作为TCP服务器接受基带设备的连接并转发信息
* port ----------- 作为TCP服务器绑定的端口号

#### UDP 将接收到的数据使用UDP发送至本地端口
* uhost ------------ 指定的UDP服务器的IP地址
* uport ------------ 制定的UDP服务器的端口号

#### time
* statitv ----------- 主控板状态发送间隔时间
* banditv ----------- 基带板信息发送间隔时间
* keepalive  ------------ 基带板在线检测时间
* sendsta_itv  ---- 采集用户信息发送间隔时间
* bandonline_itv -- 检测基带设备在线信息时间
* httptimeout ------------ http 连接超时时间

#### memry database and file
* cachefile ------------- 采集数据缓存文件名
* max_filecache ------ 缓存文件缓存条数(4/M)
* max_stacache -- 采集用户信息最大占内存数量
* dbpath ---------------- IMSI数据库保存路径
* sqltablename -------- 保存数据的数据表名称
* bsavepath --------- 基带板信息文件保存路径

#### mqttc connect
* hostip ---------------------- MQTT 服务器IP地址
* hostport -------------------- MQTT 服务器端口号
* dev_iface ----------- 用于获取MAC地址的网卡名称
* sensorname ---------- 订阅者的名称(与Topic相关)
* user_name -- 连接 MQTT 服务器的用户名(暂未用到)
* user_passwd -- 连接 MQTT 服务器的密码(暂未用到)

#### http send
* url --------------- 发送各信息的目标接口链接
* stat_api ---------------- 主控板信息上报接口
* wips_api ------------------ WIPS配置上报接口
* sync_api ------------------ 同步信息上报接口
* brand_api ----------------- 频点信息上报接口
* uesend_api ------------------ UE状态上报接口
* station_api --------------- 用户信息上报接口
* generic_api --------------- 通用配置上报接口
* redirect_api ------------ 重定向状态上报接口
* cellstat_api ---------- 小区状态信息上报接口
* baseband_api ---------- 基站设备信息上报接口
* post_gps_api --------- GPS经纬度高度上报接口
* rx_power_api -------- 增益与发射功率上报接口
* black_list_api ---------- 黑名单信息上报接口
* rem_result_api ------------ 扫频信息上报接口
* tddsubframe_api -------- TDD子帧信息上报接口
* rejectcause_api - 位置区更新拒绝原因上报接口

-------------------------------------------------------------------------------
#### 下面为配置文件示例内容
* dev_iface='eth0'
* port='3345'
* hostip='61.203.42.152'
* hostport='1883'
* url='60.205.92.158/dm_baicells/index.php/Webservice'
* stat_api='controller_save'
* cellstat_api='work_admin_state_save'
* baseband_api='basestation_save'
* station_api='client_save'
* brand_api='brand_save'
* rem_result_api='rem_result_save'
* tddsubframe_api='tdd_subframe_save'
* rejectcause_api='tau_reject_cause_save'
* dbpath='/mnt/sd/imsi_info/'
* sqltablename='imsi_info'
* bsavepath='/mnt/sd/config/'
* cachefile='/root/cache_file'
* max_filecache='1600'
* sendsta_itv='30'
* statitv='30'
* banditv='60'
* httptimeout='2'
 
-------------------------------------------------------------------------------
#### 2017.04.22 围栏新增功能
* 3.5. 采集用户信息上报
* 3.6. 系统扫频配置
* 3.7. 扫频信息上报
* 3.8. 重启指示
* 3.9. 重启指示应答
* 3.10. 小区激活去激活配置
* 3.11. 小区激活去激活配置回复
* 3.12. 心跳
* 3.13. 心跳应答
* 3.14. 接收增益配置
* 3.15. 接收增益配置应答
* 3.16. 发射功率配置
* 3.17. 发射功率配置应答
* 3.18. 重定向信息配置
* 3.19. 重定向信息配置应答
* 3.30. 设置基站同步方式 
* 3.31. 设置基站同步方式应答
* 3.34. 小区频点配置相关参数查询
* 3.35. 小区频点配置相关参数指示
* 3.36. GPS 同步偏移调节配置
* 3.37. GPS 同步偏移调节配置应答
* 3.38. 上电自动建小区配置
* 3.39. 上电自动建小区配置应答
* 3.40. 基站基本信息查询
* 3.41. 基站基本信息查询应答
* 3.42. 基站同步信息查询
* 3.43. 基站同步信息查询应答
* 3.44. 小区状态信息查询
* 3.45. 小区状态信息查询应答
* 3.46. 接收增益和发射功率查询
* 3.47. 接收增益和发射功率查询应答
* 3.54. 重定向参数配置查询
* 3.55. 重定向参数配置查询应答
* 3.56. 上电小区自激活配置 
* 3.57. 上电小区自激活配置查询应答
* 4.1. 设置基站测量 UE 配置
* 4.2. 测量 UE 配置应答 
* 4.3. UE 测量配置查询
* 4.4. UE 测量配置查询应答
* 4.5. 管控名单配置
* 4.6. 管控名单配置应答
* 4.7. 管控名单查询
* 4.8. 管控名单查询应答

#### 2017.07.22 围栏新增功能
* 3.62. 设置 TDD 子帧配置
* 3.63. 设置 TDD 子帧配置应答
* 3.64. TDD 子帧配置查询
* 3.65. TDD 子帧配置查询应答
* 3.66. 位置区更新拒绝原因值配置
* 3.67. 位置区更新拒绝原因值配置应答
* 3.68. 初始频偏配置
* 3.69. 初始频偏配置应答
* 3.73. 异频同步频点及 band 配置
* 3.74. 异频同步频点及 band 配置响应
* 3.75. 位置区更新拒绝原因查询
* 3.76. 位置区更新拒绝原因查询应答

#### 2017.08.02 围栏功能新增与修改
* 3.6. 系统扫频配置
* 3.7. 扫频/同步信息上报
* 3.48. 接收增益和发射功率查询
* 3.49. 接收增益和发射功率查询应答
* 3.54. 扫频参数配置查询
* 3.55. 扫频参数配置查询应答
* 3.73. Gps 经纬高度查询
* 3.74. Gps 经纬高度查询响应
* 3.5. 采集用户信息上报添加RSSI字段
* 3.38. AGC 配置
* 3.39. AGC 配置应答
* 3.42. 基站基本信息查询
* 3.43. 基站基本信息查询应答
* 3.60. 设置 Log
* 3.61. 设置 Log
* 3.62. 查询 log
* 3.63. 查询 log
* 3.72. 告警指示
* 3.77. Gps 信息复位配置
* 3.78. Gps 信息复位配置应答
* 3.79. 基站版本升级配置
* 3.80. 基站版本升级配置 应答
* 3.81. 获取基站log
* 3.82. 获取基站log应答
* 3.83. GPS 同步偏移量查询
* 3.84. Gps 同步偏移量查询应答
* 3.85. 小区自配置请求
* 3.86. 小区自配置请求应答
* 3.87. 频点自配置后台频点列表查询
* 3.88. 频点自配置后台频点列表查询上报
* 3.89. 频点自配置后台频点添加/删除
* 3.90. 频点自配置后台频点添加应答
* 7.1 随机接入成功率问询
* 7.2 随机接入成功率上报
* 7.3 随机接入成功率清空请求
* 7.4 随机接入成功率清空请求响应
* 7.5 TAC 手动修改配置下发
* 7.6 TAC 手动修改配置下发应答
* 7.7  辅 PLMN 列表配置
* 7.8  辅 PLMN 列表配置应答
* 7.9  辅 PLMN 列表查询
* 7.10  辅 PLMN 列表查询上报

#### 20170811更新
* 3.7扫频与同步信息查询上传已添加
* 添加485串口操作信息,增加对功放的信息查询,以及射频的开关设置功能

#### 20180814更新
*  修改了gsm模块的bug
* 3.91 新增断网自动配置功能
*  断网配置查询
*  断网配置设置
